-- Variáveis principais
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRoot = character:WaitForChild("HumanoidRootPart")
local titansFolder = game.Workspace:WaitForChild("Titans")

local damageAmount = 100
local attackRange = 30
local autoAttackEnabled = false
local titanGrabbed = false

-- Menu invisível

local function criarMenu()
    local screenGui = Instance.new("ScreenGui", player.PlayerGui)
        screenGui.Name = "MenuInvisivel"
            screenGui.ResetOnSpawn = false

                local abrirBtn = Instance.new("TextButton")
                    abrirBtn.Size = UDim2.new(0, 100, 0, 40)
                        abrirBtn.Position = UDim2.new(0.5, -50, 0.8, 0)
                            abrirBtn.Text = "Menu"
                                abrirBtn.Parent = screenGui

                                    abrirBtn.MouseButton1Click:Connect(function()
                                            abrirBtn.Visible = false
                                            
                                                    local menuFrame = Instance.new("Frame")
                                                            menuFrame.Size = UDim2.new(0, 200, 0, 150)
                                                                    menuFrame.Position = UDim2.new(0.5, -100, 0.6, 0)
                                                                            menuFrame.BackgroundColor3 = Color3.new(0, 0, 0)
                                                                                    menuFrame.BackgroundTransparency = 0.3
                                                                                            menuFrame.BorderSizePixel = 0
                                                                                                    menuFrame.Parent = screenGui
                                                                                                    
                                                                                                            local toggleBtn = Instance.new("TextButton")
                                                                                                                    toggleBtn.Size = UDim2.new(1, -20, 0, 40)
                                                                                                                            toggleBtn.Position = UDim2.new(0, 10, 0, 10)
                                                                                                                                    toggleBtn.Text = "Ativar AutoFarm"
                                                                                                                                            toggleBtn.Parent = menuFrame
                                                                                                                                            
                                                                                                                                                    toggleBtn.MouseButton1Click:Connect(function()
                                                                                                                                                                autoAttackEnabled = not autoAttackEnabled
                                                                                                                                                                            toggleBtn.Text = autoAttackEnabled and "Desativar AutoFarm" or "Ativar AutoFarm"
                                                                                                                                                                                    end)
                                                                                                                                                                                    
                                                                                                                                                                                            local fecharBtn = Instance.new("TextButton")
                                                                                                                                                                                                    fecharBtn.Size = UDim2.new(1, -20, 0, 40)
                                                                                                                                                                                                            fecharBtn.Position = UDim2.new(0, 10, 0, 60)
                                                                                                                                                                                                                    fecharBtn.Text = "Fechar Menu"
                                                                                                                                                                                                                            fecharBtn.Parent = menuFrame
                                                                                                                                                                                                                            
                                                                                                                                                                                                                                    fecharBtn.MouseButton1Click:Connect(function()
                                                                                                                                                                                                                                                menuFrame:Destroy()
                                                                                                                                                                                                                                                            abrirBtn.Visible = true
                                                                                                                                                                                                                                                                    end)
                                                                                                                                                                                                                                                                        end)
                                                                                                                                                                                                                                                                        end

                                                                                                                                                                                                                                                                        -- Verifica titãs próximos
                                                                                                                                                                                                                                                                        local function getTitanPerto()
                                                                                                                                                                                                                                                                            local menorDist = attackRange
                                                                                                                                                                                                                                                                                local maisPerto = nil
                                                                                                                                                                                                                                                                                    for _, titan in pairs(titansFolder:GetChildren()) do
                                                                                                                                                                                                                                                                                            if titan:FindFirstChild("Head") and titan:FindFirstChild("Humanoid") then
                                                                                                                                                                                                                                                                                                        local dist = (titan.Head.Position - humanoidRoot.Position).Magnitude
                                                                                                                                                                                                                                                                                                                    if dist < menorDist then
                                                                                                                                                                                                                                                                                                                                    menorDist = dist
                                                                                                                                                                                                                                                                                                                                                    maisPerto = titan
                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                return maisPerto
                                                                                                                                                                                                                                                                                                                                                                                end

                                                                                                                                                                                                                                                                                                                                                                                -- Atacar Titã
                                                                                                                                                                                                                                                                                                                                                                                local function atacarTitan(titan)
                                                                                                                                                                                                                                                                                                                                                                                    if titan and titan:FindFirstChild("Humanoid") then
                                                                                                                                                                                                                                                                                                                                                                                            titan.Humanoid:TakeDamage(damageAmount)
                                                                                                                                                                                                                                                                                                                                                                                                    print("Titã atacado com sucesso!")
                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                        end

                                                                                                                                                                                                                                                                                                                                                                                                        -- Mover até a nuca
                                                                                                                                                                                                                                                                                                                                                                                                        local function moverENucar(titan)
                                                                                                                                                                                                                                                                                                                                                                                                            if titan and titan:FindFirstChild("Head") then
                                                                                                                                                                                                                                                                                                                                                                                                                    local nuca = titan.Head.Position + Vector3.new(0, 5, 0)
                                                                                                                                                                                                                                                                                                                                                                                                                            humanoidRoot.CFrame = CFrame.new(nuca)
                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                end

                                                                                                                                                                                                                                                                                                                                                                                                                                -- Defesa contra agarrão
                                                                                                                                                                                                                                                                                                                                                                                                                                local function defender()
                                                                                                                                                                                                                                                                                                                                                                                                                                    for _, titan in pairs(titansFolder:GetChildren()) do
                                                                                                                                                                                                                                                                                                                                                                                                                                            local handL = titan:FindFirstChild("LeftHand")
                                                                                                                                                                                                                                                                                                                                                                                                                                                    local handR = titan:FindFirstChild("RightHand")
                                                                                                                                                                                                                                                                                                                                                                                                                                                            if handL and handR then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        local distL = (handL.Position - humanoidRoot.Position).Magnitude
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    local distR = (handR.Position - humanoidRoot.Position).Magnitude
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if distL < 5 or distR < 5 then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                local escape = (humanoidRoot.Position - titan.HumanoidRootPart.Position).Unit * 10
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                humanoidRoot.CFrame = CFrame.new(humanoidRoot.Position + escape)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                titanGrabbed = true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                print("Desviando do agarrão!")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            titanGrabbed = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- Camuflagem de movimento
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            local function camuflar()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                local movimentos = {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Vector3.new(1, 0, 0),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Vector3.new(-1, 0, 0),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Vector3.new(0, 0, 1),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Vector3.new(0, 0, -1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    humanoidRoot.CFrame = humanoidRoot.CFrame + movimentos[math.random(1, #movimentos)]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -- Detecta admins por nome
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    local function detectarAdmin()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        local suspeitos = {"admin", "mod", "dev"}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            for _, p in pairs(game.Players:GetPlayers()) do
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    local nome = p.Name:lower()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            local nick = p.DisplayName:lower()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    for _, palavra in pairs(suspeitos) do
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if string.find(nome, palavra) or string.find(nick, palavra) then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                warn("Administrador ou moderador detectado!")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                game:Shutdown()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -- Execução principal
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            task.spawn(function()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                criarMenu()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    while true do
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            task.wait(1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if detectarAdmin() then break end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            camuflar()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    defender()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if autoAttackEnabled and not titanGrabbed then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        local titan = getTitanPerto()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if titan then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    moverENucar(titan)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    atacarTitan(titan)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }